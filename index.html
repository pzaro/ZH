<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ZARKOLIA Lab</title>
    
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#1a237e">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/3004/3004458.png">

    <style>
        /* --- Î“Î•ÎÎ™ÎšÎŸ Î£Î¤Î¥Î› --- */
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: #f4f7f6; padding: 15px; color: #333; margin: 0; }
        
        /* --- Login Screen --- */
        #loginOverlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #1a237e; z-index: 9999; display: flex; flex-direction: column; justify-content: center; align-items: center; color: white; }
        #loginBox { background: white; padding: 30px; border-radius: 15px; text-align: center; width: 80%; max-width: 300px; box-shadow: 0 10px 25px rgba(0,0,0,0.3); }
        #passwordInput { padding: 15px; font-size: 1.2em; width: 100%; box-sizing: border-box; margin-bottom: 15px; border: 2px solid #ddd; border-radius: 8px; text-align: center; }
        #loginBtn { background: #ff5722; color: white; border: none; padding: 15px; width: 100%; border-radius: 8px; font-size: 1.1em; font-weight: bold; cursor: pointer; }
        
        /* --- Main App --- */
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); display: none; }
        h1 { text-align: center; color: #1a237e; margin: 10px 0; font-size: 1.4em; }
        p.subtitle { text-align: center; color: #666; font-size: 0.9em; margin-bottom: 20px; }
        
        .control-panel { background: #e8eaf6; padding: 20px; border-radius: 12px; border: 1px solid #c5cae9; }
        label { display: block; margin-bottom: 8px; font-weight: 600; color: #3f51b5; }
        select, input[type="number"] { padding: 15px; font-size: 1.1em; border-radius: 10px; border: 2px solid #3f51b5; width: 100%; box-sizing: border-box; font-weight: bold; background: white; }
        
        .btn-group { display: flex; gap: 10px; margin-top: 25px; }
        button { flex: 1; padding: 15px; font-size: 1em; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; text-transform: uppercase; letter-spacing: 1px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .btn-calc { background-color: #3f51b5; color: white; }
        .btn-print { background-color: #546e7a; color: white; }

        /* --- Checkboxes --- */
        .checkbox-group { display: flex; flex-direction: column; gap: 10px; margin-top: 20px; align-items: center; }
        .checkbox-wrapper { display: flex; align-items: center; gap: 10px; font-size: 0.95em; cursor: pointer; }
        input[type="checkbox"] { transform: scale(1.3); }

        /* --- Result Table --- */
        #resultContainer { margin-top: 30px; display: none; border: 1px solid #eee; border-radius: 10px; overflow: hidden; }
        table { width: 100%; border-collapse: collapse; font-size: 0.9em; }
        th, td { padding: 10px; border-bottom: 1px solid #eee; }
        th { background: #f5f5f5; }
        .amount-col { text-align: right; color: #2e7d32; font-weight: bold; }
        
        /* --- LABEL PREVIEW (Hidden on Screen) --- */
        #labelPreview { 
            display: none; 
            border: 1px dashed #333; 
            width: 62mm; height: 100mm; 
            margin: 20px auto; 
            padding: 5mm; 
            box-sizing: border-box;
            background: white;
            text-align: center;
        }

        /* --- PRINT SETTINGS --- */
        @media print {
            /* Î‘Ï€ÏŒÎºÏÏ…ÏˆÎ· ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ UI */
            #loginOverlay, .control-panel, h1, .subtitle { display: none !important; }
            .container { box-shadow: none; margin: 0; padding: 0; width: 100%; max-width: none; }

            /* Default: Î¤Ï…Ï€ÏÎ½ÎµÎ¹ ÏƒÏ…Î½Ï„Î±Î³Î®, ÎºÏÏÎ²ÎµÎ¹ ÎµÏ„Î¹ÎºÎ­Ï„Î± */
            #resultContainer { display: block; }
            #labelPreview { display: none; }

            /* ÎŒÏ„Î±Î½ ÎµÎ¯Î½Î±Î¹ ÎµÎ½ÎµÏÎ³ÏŒ Ï„Î¿ Label Mode */
            body.print-label-mode #resultContainer { display: none !important; }
            body.print-label-mode #labelPreview { 
                display: flex !important; 
                flex-direction: column;
                justify-content: center;
                align-items: center;
                position: absolute; 
                top: 0; left: 0;
            }
            
            /* Î¡ÏÎ¸Î¼Î¹ÏƒÎ· ÏƒÎµÎ»Î¯Î´Î±Ï‚ Î³Î¹Î± Brother QL-800 */
            body.print-label-mode { margin: 0; padding: 0; }
            @page {
                size: 62mm 100mm; /* ÎšÏÎ¯ÏƒÎ¹Î¼Î¿ Î³Î¹Î± Brother */
                margin: 0;
            }
        }
    </style>
</head>
<body>

<div id="loginOverlay">
    <div id="loginBox">
        <h2 style="color:#1a237e; margin-top:0;">ZARKOLIA LAB</h2>
        <input type="password" id="passwordInput" placeholder="Password">
        <button id="loginBtn" onclick="checkLogin()">Î•Î™Î£ÎŸÎ”ÎŸÎ£</button>
        <p id="errorMsg" style="color:red; display:none; margin-top:10px;">Î›Î¬Î¸Î¿Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚</p>
    </div>
</div>

<div class="container" id="mainApp">
    <h1>ZARKOLIA LAB</h1>
    <p class="subtitle">Production & Labeling v15</p>
    
    <div class="control-panel">
        <label>Î•Î Î™Î›ÎŸÎ“Î— Î Î¡ÎŸÎªÎŸÎÎ¤ÎŸÎ£</label>
        <select id="recipeSelect" onchange="toggleInputs()">
            <option value="" disabled selected>-- Î•Ï€Î¹Î»Î­Î¾Ï„Îµ --</option>
            <optgroup label="Î£Î¹ÏÏŒÏ€Î¹">
                <option value="syrup_custom">CUSTOM ALTHEA SYRUP (66.7%)</option>
            </optgroup>
            <optgroup label="ÎšÏÎ­Î¼ÎµÏ‚ Î ÏÎ¿ÏƒÏÏ€Î¿Ï…">
                <option value="plus">Revitacell Plus (ÎÎ­Î± Î£ÏÎ½Î¸ÎµÏƒÎ·)</option>
                <option value="eyes">Revitacell Eyes (Safe 8% Arnica)</option>
                <option value="hydralia">Hydralia Face Cream</option>
            </optgroup>
            <optgroup label="Î˜ÎµÏÎ±Ï€ÎµÎ¯ÎµÏ‚ Î£ÏÎ¼Î±Ï„Î¿Ï‚">
                <option value="bruise">Bruise Off (ÎÎ­Î± Î¦ÏŒÏÎ¼Î¿Ï…Î»Î±)</option>
                <option value="zplast">Zplast Total Repair (ÎÎ­Î±)</option>
            </optgroup>
            <optgroup label="Î£Ï…Î¼Ï€Î»Î·ÏÏÎ¼Î±Ï„Î±">
                <option value="zboost">Z-Boost Caps</option>
            </optgroup>
            <optgroup label="Î’Î¬ÏƒÎµÎ¹Ï‚">
                <option value="base">Î’Î¬ÏƒÎ· Gel-Cream</option>
            </optgroup>
        </select>

        <div style="margin-top:15px;" id="standardInput">
            <label>Î£Î¤ÎŸÎ§ÎŸÎ£ Î Î‘Î¡Î‘Î“Î©Î“Î—Î£ (g)</label>
            <input type="number" id="totalWeightInput" value="1000" step="50">
        </div>

        <div style="margin-top:15px; display:none;" id="capsuleInput">
            <label>ÎšÎŸÎ¥Î¤Î™Î‘ (x30)</label>
            <input type="number" id="boxCount" value="10">
        </div>
        
        <div class="checkbox-group">
            <div class="checkbox-wrapper">
                <input type="checkbox" id="showInstructions" checked>
                <label for="showInstructions">ÎŸÎ´Î·Î³Î¯ÎµÏ‚ Î Î±ÏÎ±ÏƒÎºÎµÏ…Î®Ï‚</label>
            </div>
            <div class="checkbox-wrapper" style="color:#d84315; font-weight:bold;">
                <input type="checkbox" id="printLabelMode" onchange="togglePrintMode()">
                <label for="printLabelMode">ğŸ–¨ï¸ Î•ÎºÏ„ÏÏ€Ï‰ÏƒÎ· Î•Ï„Î¹ÎºÎ­Ï„Î±Ï‚ (62mm)</label>
            </div>
        </div>

        <div class="btn-group">
            <button class="btn-calc" onclick="calculate()">Î¥Î ÎŸÎ›ÎŸÎ“Î™Î£ÎœÎŸÎ£</button>
            <button class="btn-print" onclick="window.print()">Î•ÎšÎ¤Î¥Î Î©Î£Î—</button>
        </div>
    </div>

    <div id="labelPreview">
        <div style="font-weight:bold; font-size:12pt; border-bottom:2px solid black; width:100%; padding-bottom:5px;">ZARKOLIA LAB</div>
        <div id="lblTitle" style="font-size:16pt; font-weight:900; margin:15px 0; line-height:1.2;">PRODUCT TITLE</div>
        
        <div style="text-align:left; width:100%; margin-top:10px; font-size:10pt;">
            <strong>Î—Î¼. Î Î±ÏÎ±Î³Ï‰Î³Î®Ï‚:</strong> <span id="lblProdDate">--/--/----</span>
        </div>
        <div style="text-align:left; width:100%; margin-top:5px; font-size:10pt;">
            <strong>Î—Î¼. Î›Î®Î¾Î·Ï‚:</strong> <span id="lblExpDate">--/--/----</span>
        </div>
        
        <div style="margin-top:15px; border-top:1px solid #333; padding-top:5px; font-size:9pt;">
            Batch No: <span id="lblBatch">AUTO</span>
        </div>
        <div style="margin-top:20px; font-size:8pt; color:#555;">
            Store in cool dry place<br>Made in Greece
        </div>
    </div>

    <div id="resultContainer"></div>
</div>

<script>
    const _0x9f2a = "54e36ecfb4491012abb5b6b66a485b41fd2fe30a6899e7ddc4c9ded7f7caee2e";

    async function checkLogin() {
        const input = document.getElementById('passwordInput').value;
        if (!input) return;
        const encoder = new TextEncoder();
        const data = encoder.encode(input);
        const hashBuffer = await crypto.subtle.digest('SHA-256', data);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
        if (hashHex === _0x9f2a) {
            document.getElementById('loginOverlay').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
        } else {
            alert("Î›Î¬Î¸Î¿Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚");
        }
    }

    function togglePrintMode() {
        const isLabel = document.getElementById('printLabelMode').checked;
        if (isLabel) {
            document.body.classList.add('print-label-mode');
        } else {
            document.body.classList.remove('print-label-mode');
        }
    }

    // --- RECIPES (Added 'shelfLife' in months) ---
    const recipes = {
        plus: {
            title: "REVITACELL PLUS",
            desc: "New Formula",
            type: "standard",
            shelfLife: 12, // 12 Months
            ingredients: [
                { name: "Î’Î¬ÏƒÎ· Gel-Cream", pct: 0, isQS: true },
                { name: "Almond Oil", pct: 2.0 }, { name: "Avocado Oil", pct: 2.0 },
                { name: "Jojoba Oil", pct: 2.0 }, { name: "Pomegranate Oil", pct: 2.0 },
                { name: "Mastic Oil", pct: 1.0 }, { name: "Mastic Tincture", pct: 3.0 },
                { name: "Vit E", pct: 0.5 }
            ],
            instructions: ["1. ÎœÎ¯Î¾Î· Î»Î±Î´Î¹ÏÎ½ & Î’Î¹Ï„ Î•.", "2. Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î²Î¬Î¼Î¼Î±Ï„Î¿Ï‚ ÏƒÏ„Î± Î»Î¬Î´Î¹Î±.", "3. Î•Î½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎ· ÏƒÏ„Î· Î²Î¬ÏƒÎ·."]
        },
        syrup_custom: {
            title: "ALTHEA SYRUP",
            desc: "Custom 66.7%",
            type: "standard",
            shelfLife: 6, // 6 Months
            ingredients: [
                { name: "Fructose", pct: 66.70 }, { name: "Aqua", pct: 0, isQS: true },
                { name: "Sodium Benzoate", pct: 0.10 }, { name: "--- Î’Î‘ÎœÎœÎ‘Î¤Î‘ (5%) ---", isHeader: true },
                { name: "Mix Tinctures", pct: 5.0 }, { name: "Lemon Juice (pH adj)", pct: 0 }
            ],
            instructions: ["1. Î–Î­ÏƒÏ„Î±Î¼Î± Î½ÎµÏÎ¿Ï.", "2. Î”Î¹Î¬Î»Ï…ÏƒÎ· Ï†ÏÎ¿Ï…ÎºÏ„ÏŒÎ¶Î·Ï‚.", "3. Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Ï…Ï€Î¿Î»Î¿Î¯Ï€Ï‰Î½ <40C.", "4. pH < 4.5."]
        },
        eyes: {
            title: "REVITACELL EYES",
            desc: "Arnica 8%",
            type: "standard",
            shelfLife: 12,
            ingredients: [
                { name: "Î’Î¬ÏƒÎ· Gel-Cream", pct: 0, isQS: true }, { name: "Arnica Oil", pct: 8.0 },
                { name: "Oils (Jojoba/Almond)", pct: 2.0 }, { name: "Hyaluronic", pct: 4.0 }
            ],
            instructions: ["1. ÎœÎ¯Î¾Î· Î»Î±Î´Î¹ÏÎ½.", "2. Î•Î½ÏƒÏ‰Î¼Î¬Ï„Ï‰ÏƒÎ·."]
        },
        bruise: {
            title: "BRUISE OFF",
            desc: "Stearic Formula",
            type: "standard",
            shelfLife: 18,
            ingredients: [
                { name: "Oil Phase", pct: 31.0 }, { name: "Water Phase", pct: 0, isQS: true }
            ],
            instructions: ["1. Î˜Î­ÏÎ¼Î±Î½ÏƒÎ· 75C.", "2. ÎŸÎ¼Î¿Î³ÎµÎ½Î¿Ï€Î¿Î¯Î·ÏƒÎ·.", "3. ÎšÏÏÏ‰Î¼Î±."]
        },
        zboost: {
            title: "Z-BOOST CAPS",
            desc: "Ginger/ALA",
            type: "capsule",
            shelfLife: 24,
            capsuleContentWeight: 0.5864,
            ingredients: [{name:"Mix Powders", pct:100}],
            instructions: ["1. Î‘Î½Î¬Î¼ÎµÎ¹Î¾Î·.", "2. Î Î»Î®ÏÏ‰ÏƒÎ·."]
        },
        zplast: {
            title: "ZPLAST REPAIR",
            desc: "Total Repair",
            type: "standard",
            shelfLife: 12,
            ingredients: [{name:"See Full Recipe", pct:100}],
            instructions: ["See file."]
        },
        hydralia: {
            title: "HYDRALIA FACE",
            desc: "Moisturizing",
            type: "standard",
            shelfLife: 12,
            ingredients: [{name:"See Full Recipe", pct:100}],
            instructions: ["See file."]
        },
        base: {
            title: "BASE GEL-CREAM",
            desc: "Base",
            type: "standard",
            shelfLife: 12,
            ingredients: [{name:"Base Mix", pct:100}],
            instructions: ["See file."]
        }
    };

    function toggleInputs() {
        const key = document.getElementById('recipeSelect').value;
        const isCap = recipes[key]?.type === 'capsule';
        document.getElementById('standardInput').style.display = isCap ? 'none' : 'block';
        document.getElementById('capsuleInput').style.display = isCap ? 'block' : 'none';
        document.getElementById('resultContainer').style.display = 'none';
    }

    function calculate() {
        const key = document.getElementById('recipeSelect').value;
        if (!key) return alert("Î•Ï€Î¹Î»Î­Î¾Ï„Îµ Ï€ÏÎ¿ÏŠÏŒÎ½");
        const recipe = recipes[key];
        
        // --- CALCULATION LOGIC (Simplified for brevity in Label Demo) ---
        let weight = parseFloat(document.getElementById('totalWeightInput').value);
        if (recipe.type === 'capsule') weight = 100; // dummy
        
        // --- LABEL GENERATION LOGIC ---
        const now = new Date();
        const exp = new Date();
        const shelfMonths = recipe.shelfLife || 12; 
        exp.setMonth(exp.getMonth() + shelfMonths);

        // Format Date: DD/MM/YYYY
        const formatDate = (d) => `${String(d.getDate()).padStart(2,'0')}/${String(d.getMonth()+1).padStart(2,'0')}/${d.getFullYear()}`;
        
        document.getElementById('lblTitle').innerText = recipe.title;
        document.getElementById('lblProdDate').innerText = formatDate(now);
        document.getElementById('lblExpDate').innerText = formatDate(exp);
        document.getElementById('lblBatch').innerText = now.getFullYear().toString().substr(-2) + String(now.getMonth()+1).padStart(2,'0') + String(now.getDate()).padStart(2,'0');

        // --- RENDER TABLE ---
        let html = `<div style="padding:10px; background:#e3f2fd; font-weight:bold; text-align:center;">${recipe.title}</div><table>`;
        recipe.ingredients.forEach(i => {
            html += `<tr><td>${i.name}</td><td class="amount-col">${i.pct}%</td></tr>`;
        });
        html += `</table>`;
        
        if(document.getElementById('showInstructions').checked && recipe.instructions) {
            html += `<div style="background:#f1f8e9; padding:10px; margin-top:10px;"><ul>${recipe.instructions.map(s=>`<li>${s}</li>`).join('')}</ul></div>`;
        }

        document.getElementById('resultContainer').innerHTML = html;
        document.getElementById('resultContainer').style.display = 'block';
        
        // Ensure checkbox sync
        togglePrintMode();
    }
</script>

</body>
</html>
